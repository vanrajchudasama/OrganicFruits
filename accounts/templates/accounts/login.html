{% extends 'shop_base.html'%}
{%load static%}
{%block title%}Login{%endblock%}
{%block style%}
<style>
    .errorlist{
        list-style-type: none;
        margin: 0;
        padding: 0;
    }
    .errorlist > li{
        display: inline;
        color: red;
    }
    form i{
        left: -30px;
        bottom: -8px;
        position: relative;
        cursor: pointer;
        z-index: 5;
    }
    
</style>
{%endblock%}
{%block content%}

{% if messages %}
{% for message in messages %}

{% if message.tags == 'success' %}


<div class="alert alert-success alert-dismissible fade show" role="alert">
    <strong>{{ message.tags |upper }} : </strong>  {{ message }}
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
  </div>
{%else%}
<div class="alert alert-warning alert-dismissible fade show" role="alert">
    <strong>{{ message.tags |upper }} : </strong>  {{ message }}
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
  </div>
{% endif %}

{% endfor %}

{% endif %}
<div class="row justify-content-center m-3">

    <div class="col-lg-4 col-sm-12 col-md-6  shadow p-5 border border-success rounded">
        <h5 class="alert alert-success text-center p-2">Login</h5>
     
        <form action="{% url 'login'%}" method="post" novalidate>
            {% csrf_token %}
           
            <div class="form-group">
                <label for="">Email</label>
                <div class="input-group mb-2">
                    <div class="input-group-prepend">
                      <div class="input-group-text bg-success text-white">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="30" fill="currentColor" class="bi bi-envelope-fill" viewBox="0 0 16 16">
                            <path d="M.05 3.555A2 2 0 0 1 2 2h12a2 2 0 0 1 1.95 1.555L8 8.414.05 3.555ZM0 4.697v7.104l5.803-3.558L0 4.697ZM6.761 8.83l-6.57 4.027A2 2 0 0 0 2 14h12a2 2 0 0 0 1.808-1.144l-6.57-4.027L8 9.586l-1.239-.757Zm3.436-.586L16 11.801V4.697l-5.803 3.546Z"/>
                          </svg>
                      </div>
                    </div>
                    {% if form.email.value != None %}
                <input type="email" name="email" value="{{form.email.value}}" class="form-control " required="" id="id_email">
                {%else%}
                <input type="email" name="email" class="form-control " required="" id="id_email">

                {%endif%}
                </div>
                <div class="text-danger">
                    {{form.email.errors}}
                </div>
            </div>
            <div class="form-group">
                <label for="">Password</label>

                <div class="input-group mb-2">
                    <div class="input-group-prepend">
                      <div class="input-group-text bg-success text-white">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="30" fill="currentColor" class="bi bi-key-fill" viewBox="0 0 16 16">
                            <path d="M3.5 11.5a3.5 3.5 0 1 1 3.163-5H14L15.5 8 14 9.5l-1-1-1 1-1-1-1 1-1-1-1 1H6.663a3.5 3.5 0 0 1-3.163 2zM2.5 9a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/>
                          </svg>
                      </div>
                    </div>
                    {% if form.email.value != None %}

                    <input type="password" style="position: relative;" name="password" value="{{form.password.value}}" class="form-control form-control-sm"  id="id_password">
                    {%else%}
                    <input type="password" style="position: relative;" name="password" class="form-control form-control-sm"  id="id_password">

                    {%endif%}
                    <i class="bi bi-eye-slash" id="togglePassword"></i>
                    </div>
                    <div class="text-danger">
                        {{form.password.errors}}
                    </div>

                
            </div>

            <hr class="bg-success">
           
            <div class="d-flex flex-row justify-content-center">
                    <button type="submit"  class="btn btn-block btn-success ">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-lock-fill" viewBox="0 0 16 16">
                            <path d="M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2zm3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z"/>
                          </svg>
                        Log In
                    </button>

            </div>
            <div class="d-flex p-2  justify-content-between">
                <a href="{% url 'password_reset' %}" style="bottom: 0;left: 0;"  class="d-inline">Forgot Password ?</a>
                <a href="{%url 'register'%}" style="bottom: 0;right: -10;"  class="d-inline">Create Account?</a>

            </div>
        </form>
    </div> 
</div>
{%endblock%}

{%block script%}
{{block.super}}
<script>
    const togglePassword = document.querySelector("#togglePassword");
    const password = document.querySelector("#id_password");

    togglePassword.addEventListener("click", function () {
        // toggle the type attribute
        const type = password.getAttribute("type") === "password" ? "text" : "password";
        password.setAttribute("type", type);
        
        // toggle the icon
        this.classList.toggle("bi-eye");
    });

    // prevent form submit
    // const form = document.querySelector("form");
    // form.addEventListener('submit', function (e) {
    //     e.preventDefault();
    // });
</script>
{%endblock%}

